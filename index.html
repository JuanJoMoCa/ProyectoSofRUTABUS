<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RUTABUS - Rutas de Xalapa</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

  <!-- App CSS -->
  <link rel="stylesheet" href="./css/style.css" />

  <!-- Estilos para los nuevos botones -->
  <style>
    .navbar-right-container {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        align-items: center;
    }
    #guest-buttons, #user-buttons {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    .auth-btn {
      padding: 8px 15px;
      border: 1px solid #0d6efd;
      background-color: transparent;
      color: #0d6efd;
      border-radius: 5px;
      text-decoration: none;
      transition: all 0.2s ease-in-out;
      white-space: nowrap; /* Evita que el texto se parta */
    }
    .auth-btn:hover {
      background-color: #0d6efd;
      color: white;
    }
    .auth-btn-register {
      border-color: #198754;
      color: #198754;
    }
    .auth-btn-register:hover {
      background-color: #198754;
      color: white;
    }
    .auth-btn-logout {
        border-color: #dc3545;
        color: #dc3545;
    }
    .auth-btn-logout:hover {
        background-color: #dc3545;
        color: white;
    }
    .menu-icon {
        height: 40px; /* Ajustar altura */
        width: auto;
        cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- Barra superior -->
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="./img/logo.png" alt="Logo" width="80" height="60" class="d-inline-block align-text-top me-2"> RUTABUS
      </a>
    </div>

    <!-- Buscador de rutas -->
    <form class="d-none d-md-flex align-items-center ms-3" role="search" onsubmit="return false;">
      <input id="buscadorRutas"
            class="form-control form-control-sm navbar-search-input"
            type="search"
            placeholder="Buscar ruta (número o nombre)…"
            aria-label="Buscar rutas" />
    </form>

    <!-- Contenedor DERECHO para todos los botones -->
    <div class="navbar-right-container">
        <!-- Estos botones se muestran si el usuario NO está logueado -->
        <div id="guest-buttons">
            <a href="/login.html" class="auth-btn">Ingresar</a>
            <a href="/register.html" class="auth-btn auth-btn-register">Registrarse</a>
        </div>

        <!-- Estos botones se muestran si el usuario SÍ está logueado -->
        <div id="user-buttons" style="display: none;">
            <button id="logout-btn" class="auth-btn auth-btn-logout">Cerrar Sesión</button>
            <img src="./img/menu.png" alt="Menú" class="menu-icon">
        </div>
    </div>
  </nav>

  <!-- Layout -->
  <div class="container-flex">
    <!-- Barra lateral -->
    <div class="sidebar col-3">
      <h4>Rutas disponibles</h4>
      <ul id="rutasLista" class="list-group">
        <li class="list-group-item"><button class="btn btn-link ruta-btn" data-ruta="001" data-stop="1">Ruta 1: Ávila Camacho - UV</button></li>
        <li class="list-group-item"><button class="btn btn-link ruta-btn" data-ruta="002" data-stop="2">Ruta 2: Lucas Martín - Centro</button></li>
        <!-- ... resto de tus rutas ... -->
        <li class="list-group-item"><button class="btn btn-link ruta-btn" data-ruta="152" data-stop="152">Ruta 152: Circuito Precidentes - Rebsamen - Xalapa 2000 - Arco Sur - Trancas - Lazaro Cardenas - Ruiz Cortinez - Sauces - Velodromo</button></li>
      </ul>
      <p class="mt-3 text-muted">Haz clic en una ruta para mostrarla en el mapa.</p>
    </div>
    <div id="sinResultados" class="text-muted small mt-2" style="display:none;">
      No se encontraron rutas que coincidan.
    </div>

    <!-- Mapa -->
    <div id="map" class="col-9"></div>
  </div>

  <main id="map" class="col-12 col-md-8 col-lg-9"></main>

  <!-- JS de terceros -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js" defer></script>

  <!-- JS de la app -->
  <script src="./js/app.js" defer></script>

  <!-- Lógica para mostrar/ocultar botones -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const guestButtons = document.getElementById('guest-buttons');
      const userButtons = document.getElementById('user-buttons');
      const logoutBtn = document.getElementById('logout-btn');

      // Por ahora, simulamos el estado de login con localStorage.
      // Cuando integremos el login, guardaremos aquí la información del usuario.
      const user = localStorage.getItem('rutabus_user');

      if (user) {
        // Si hay un usuario, mostramos el botón de cerrar sesión
        guestButtons.style.display = 'none';
        userButtons.style.display = 'block';
      } else {
        // Si no hay usuario, mostramos los botones de ingresar y registrarse
        guestButtons.style.display = 'flex';
        userButtons.style.display = 'none';
      }

      // Funcionalidad del botón de cerrar sesión
      logoutBtn.addEventListener('click', () => {
        // Borramos al usuario de localStorage
        localStorage.removeItem('rutabus_user');
        // Recargamos la página para que se actualicen los botones
        window.location.reload();
      });
    });
  </script>

</body>
</html>

